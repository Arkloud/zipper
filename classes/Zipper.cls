public class Zipper 
{

    //public static String bigZip = '504B030414000600080000002100621D98467A0100008E050000130008025B436F6E74656E745F54797065735D2E786D6C20A2040228A000020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000B4544D4F834010BD9BF81FC85E0D6CEBC11853DA83D6A336B1C6F37677281B6177B3B3FDFAF70E5049350D54AB171258DEC73C78339A6CCB225A83476D4DCA86C9804560A455DA2C53F63A7F8C6F59844118250A6B20653B4036195F5E8CE63B071811DA60CAF210DC1DE72873280526D681A193CCFA5204BAF54BEE847C174BE0D783C10D97D60430210E15071B8F1E2013AB2244D32D3D6E9C109C45F7CD7B9554CA847385962290515E9DF2A3380F057600D7467D7317EF9D2584ACC931D70EAFF60ACF148DD70AA299F0E14994E4836FAC575C59B92A6986A4DBE8113D9B655A428BAFD89CB7121029F3B248DA935268D3EB03C3AE00FC7B170DEF89F26F3AE4D32C03491FBB3F8F12E36AE8A49138C0F6AB410814D229225F7FC1B82F74DC33F75AD8C0E2E5DF5C1C90F71AC9A81B73B128E084C47F18464BDD6B2250DF81D7D7E1D93E6A9A2E496AC6CC5B87B43FFC2FC6FE2C7A858EA9720E7CD0D059F5569196CFD9F341B5DD14A823DABCDEA6E30F000000FFFF0300504B030414000600080000002100C2609AF3F40000004E0200000B0008025F72656C732F2E72656C7320A2040228A0000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008C92C14A03311086EF82EF10E6DE9D6D051169B617117A13A90F3024D3DDA5BB4948466DDFDE41545C586B8F4966BEF9E627EBCD711CCC1BE7D2C7606159D56038B8E8FBD05A78D93D2EEEC014A1E06988812D9CB8C0A6B9BE5A3FF340A24DA5EB53314A09C5422792EE118BEB78A452C5C4415FF6318F247ACC2D2672076A1957757D8BF937039A09D36CBD85BCF54B30BB53D2C9FFB3E37EDF3B7E88EE75E4203323705AA164CA2D8B85F7983DFAAFC64A9501E76D5697DBFCBD298E2CE449085DCCBC485973CAD26BB23F42EAF2A4D7E5B3E29CD0CDE542D3E5E7E2E1A370F0ECCF2B514ADF4638F905CD07000000FFFF0300504B030414000600080000002100006875E120010000B90300001C000801776F72642F5F72656C732F646F63756D656E742E786D6C2E72656C7320A2040128A0000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000AC93CD4EC3301084EF48BC83E53B7152A02054A71740EA158238BBCE3AB188EDC85E7EF2F69854A5895AC225174BBB2BCF7C6B8D57EB2FD3900FF0413BCB6996A4948095AED4B6E2F4A578BCB8A524A0B0A5689C054E3B08749D9F9FAD9EA011182F855AB78144151B38AD11DB3BC682ACC18890B8166C9C28E78DC058FA8AB542BE890AD8224D97CC0F35683ED2249B9253BF292F2929BA363AFFAFED94D212EE9D7C3760F184050B8018370B5153F80A90D37D27899C949D46B89A13E113B6CF471483E614C8F59C20CA592CC4B681C363FCB6A620967342600CCA00A02F597F66530CD99C0C01BB26A6FA1089BE9EB25FFC616FB4F42E3885897486EDE2F813C39B71D2D9CEF15563FDA014483C321F8CF61C6CF4E1F26F000000FFFF0300504B0304140006000800000021007A2B808D4B0200007606000011000000776F72642F646F63756D656E742E786D6CA455C18EDA3010BD57EA3F44BE431244591401AB2DD0D51E2A55A53D57C671128BD863D90E29FDFA8E1312D2B2ADD8DD0B8933F3DEBC37B687C5FD4F5906476EAC00B524F1382201570C52A1F225F9FEEDD3684E02EBA84A69098A2FC9895B72BF7AFF6E512729B04A72E502A45036A9355B92C2399D84A1650597D48EA560062C646ECC4086906582F1B006938693288E9A376D80716BB1DE9AAA23B5E44C27E136364959473C89A27928A9503DC7B522D05CA1DE0C8CA4CE8EC1E48830874A8F50A1A64EEC4529DC09F545B39EE6B8249551C9D9D5A877E531090A488EB2EC9251F6BF73DB0E24EDA343982BA3CF886C219B73CB1B79A1E1250A06650BA12F7D7B2D1BF6A3E824FDD7F0C06CADE3E955BDBE3DB76CFAC6D01AF7BE2B5CEB2BBA679A91B62059B67DF007EA728CFE668CA31B76C453F41A6E91F067CD4EC9F0F0D5AF6BCDE524D51AAFE05B2ED4A3814AF7AEB4781BDB933AF45C7E12BC4059346BAEFAD09A7D11C1D5ACD81554731248963CE50A0CDD97A8083B1EF8134956389DF6909EFC53077582D32DFDBA2451B49DC5DB8707D27DDAF08C56A5F391BB75B45EB748E3616EF514501938A14E8BD02FFD6F13D9031CFCC8D8396A1C328914F19E525189227E3CC247CA0E246C45B4B95B95F69918402AEDC39633F7C5746AAE05EE303EF8DAD8C977BF1050E3AC9E4CA64DDD02DF3FCCF1BD29A9F3CFD4533AC0AB144FDB1423F20299E279D420F6E01CC84BB8E4D9205A709A721C4A77932639037083655EB966792EC7A0B458CD6ACAD0BC87B4FE5A6B8DD57627D073F787B1FA0D0000FFFF0300504B0304140006000800000021009D5C8BBE10070000871D000015000000776F72642F7468656D652F7468656D65312E786D6CEC594F6F1B4514BF23F11D467B6F13274E9A4475AAD8B109B469A3D82DEA71BC3BF64E33BBB39A1927F10DB547242444411CA8C48D03022AB51297F269024550A47E05DECCECAE77E271E39400153487D63BFB7B6FDEFBBD3FF367AF5E3B4E183A2442529E3682DAE5C5009134E4114D878DE076AF73692D4052E134C28CA7A4118C890CAE6DBEFBCE55BCA162921004F2A9DCC08D20562ADB585890210C63799967248577032E12ACE0510C1722818F406FC2169616175717124CD300A53801B5B706031A12D4D32A83CD42799BC163AAA41E0899E86AD5C49130D8E8A0A611722C5B4CA043CC1A01CC13F1A31E39560162582A78D10816CD5FB0B07975016FE4424CCD90ADC875CC5F2E970B44074B664E31EC9793D63AF5F52BDBA57E03606A1AD76EB75BED5AA9CF00701882A7D696AACE7A67ADD62C745640F6E7B4EED6E2CA62DDC557F42F4FD9BCDE6C3657D6735BAC5203B23FEB53F8B5C5D5FAD6928337208B5F99C2D79B5BADD6AA8337208B5F9DC277AEACAFD65DBC01C58CA60753681DD04E27D75E42069CED78E16B005F5BCCE113146443995D7A8A014FD5AC5C4BF03D2E3A00D04086154D911A67648043C8E21666B42FA89E006F105C796387423935A4E742321434538DE0830C43454CF4BD7CF6DDCB674FD0C9FDA727F77F3C79F0E0E4FE0F569123B583D36155EAC5379FFEF1E823F4FB93AF5F3CFCDC8F9755FC2FDF7FFCF34F9FF981503E13739E7FF1F8D7A78F9F7FF9C96FDF3EF4C0B704EE57E13D9A10896E9223B4CF1370CCB0E25A4EFAE27C12BD18D3AAC4563A9438C57A168FFEB68A1DF4CD3166D8836B1297C13B02DA870FF8DEE89E637037162395C7DBF1EC7A9C38C05DCE59930B2F0BD7F55C159A7BA374E89F5C8CAAB87D8C0F7D73B770EAC4B73DCAA06F529FCA564C1C33F7184E151E929428A4DFF103423C7CDDA5D4E1759786824B3E50E82E454D4CBD94F468DFC9A689D00E4D202E639F81106F879BDD3BA8C999CFEB6D72E822A12A30F318DF23CCA1F13D3C5238F1A9ECE1845509BF8155EC33B23B166115D7960A223D248CA37644A4F4C9DC12E06F25E8D7A175F8C3BECBC6898B148A1EF874DEC09C5791DBFCA015E324F361BB348DABD8F7E501A428467B5CF9E0BBDCAD10FD0C71C0E9CC70DFA1C409F7D9DDE0361D3A264D1244BF19091D4B68D54E074E68FAAA769C4037CEDDB9B8760C0DF0F9578F3C99F5A636E22D20C157093BA7DAEF2CDCE9A6DBE222A26F7ECFDDC6A3748F409A4F2F3C6F5BEEDB961BFCE75BEEAC7A9EB7D14E7A2BB45DBDBDB19B62B3454E66EE900794B1AE1A3372439A4DB2847522EAC0A09633A743529E98B2187EE67DDDC10D0536324870F521557137C6196CB06B81563294B9EAA144199770B033C35EDD1A0F9B74658F852BFAC060FB81C46A97477678590F17E782528D596D86E6F0594CB4AC15CC3BD9F2955C29B8FD3A93D5B45173CF5633A69956E7CC56BA0C319C760D064B3661038260DB022CAFC2F95C4F0D0713CC48A479B76B6F11161385BF2744B9D7D6911847C486C819AEB05933B12B52C85C10404A7942773E364BD680B4B38D3069313B7FE624B95030215997DDA96A6269B5B6588A8E1AC1FACAD24A80429C3582011C49E1679241D0A4DEB26136847B9D50099BB567D6A229D289C7EBFEACAAC12DC38C8271CA3813526D6319DB189A5779A858AA67B2F62FADD475B25D8C0336515FC38AE53548917FCD0A08B51B5A3218905055835D19D1DCD9C7BC13F29122A21B4747A8CF46621F43F88153ED4F4425DC2C9882D60F700DA6D936AFDCDE9A779AEAE593C1D971CCB218E7DD525FA3141567E1A6DE4A1BCC53C53CF0CD6BBB71EEFCAEE88ABF2857AA69FC3F73452F0770D05F8E740442B8851518E97A6D045CA8984317CA621A7604ACFBA67740B6C0552ABC06F2E12ED8FC2FC8A1FEDFD69CD561CA1ACE6B6A9F0E91A0B09CA85810B2076DC964DF19CA6AF9D26355B25C91C9A88AB932B366F7C921613DDD0357750F0E500CA96EBA49DE060CEE74FEB9CF7905F5877A8F52AD37A787944BA7AD817F7AE3628B199C3AB597D0F95BF05F9AE859FDACBC112FD6C8AA23FAC56497542FAAC259FCD6D7F3A95ED3847916E0CA5A6B3BD694C74B2B857110C5698F61B0DCCF64705D83F43FB0FE511132FB61412FA83DBE0FBD15C17702CB1F82ACBEA4BB1A64906E90F6571FF63D76D026935665A9CD773E9AB562B1BEE08D6A39EF29B2B565F3C4FB9C64979B28773AA7162F92EC9C61876B3B36936A88ECE91285A141710E3181315FA4AA1F8D78FF1E047A1BAEE747CC7E4692193C993AC8F684C9AE3E8FC6F94F26ED826BB34E9F613492A5FB648068745C9C3F4A266C09D94F19C516D9A0B5984EB45270D97768700573BC16B5AB6529BC74B67029616686965D0A9B1B329F02F89095376E7DB403BC6DB2D66B5D5C05532CFD2B94CD61BC9F32EFC9675ECAEC41F195817A0DCAD4F1AB29CB9902F2A6130F3E450A0C4793AEE9BFB0E8D84C3729BBF927000000FFFF0300504B0304140006000800000021008F705570C50300008F09000011000000776F72642F73657474696E67732E786D6CB456596FE336107E2FD0FF60E8B98E255F4985380B478E7713C46DB0CAF69D92C6361B1E024945EBFCFA0E49316A61AFBBE8A24F1ECDF1CD3DF4F587AF9C0D5E41692AC5224A2EE26800A2941515BB45F4E5793DBC8A06DA10511126052CA203E8E8C3CDCF3F5DB7A90663504D0F1042E894978B686F4C9D8E46BADC0327FA42D62050B8958A13839F6A37E244BD34F5B094BC268616945173188DE3781E75307211354AA41DC490D352492DB7C69AA472BBA525743FC1427D8F5F6FB99265C34118E771A480610C52E83DAD7540E3FF150D53DC0790D77349BC7216F4DA243EA7D9A5DB4A55BD5B7C4F78D6A056B204ADB1419CF97439A1E21D26991E01BD97FA024B3DF2BE47160ACD93D8517DE49A1DD99FE8B6EFE2232D1451BECD3800360A5EA6F73B211529180E559B4CA31B9CA83729F9A04D6B50253609C7711647232B005E40951FB401BE96C268C7C40CE53637C400DAE81A1873435B3220E8A14D778A701CB745E439CEA6822D69987926456E648D4AAF0413B91C777E2A455A04F9A868F5492AFA86BE08CB6B522233284FE6C7CA7F8032B43CA34A75CDC8A1C75CF58EEE70FB0E013C407BFD00FB2FDAE59E28521A505DA41986AD240B9895FC4D9A0C174EE13CF87AFAF5B3956D34ACEF1EC94136C615C84B72BFDA882008C706796EB7AE1B5981AD6FA3E8D10C7C7386AC81AB35B6FA8C2389C5C0E2033688416E0E0C6CBF73FA064B513D34DA503C006E697F2082730180B09E7FC7C3F57CA8610DC43458B6FFC999EBCC9AD17A439592EA5E5438F63FEA6CD4A67D7BF1AE57DAF6D9129FA534A10D717C99C559D635C34A7BC9F836892F67BE4AFF94CCD6B355B23E25F936DAD5385E65B7A76CB26C9ECC4EFAB99B2777CBE5299BF57C7AE9D130CF2E3B9EDADBFBA46EAE3D654766C0FDB86584178A92C1C65E671C3C9E16EAE5968A202F005F27F8BB246F8A201C0EBD4073C2D81A77CC0154B89C2BD83A9A6D88DAF5686E7D79AA4E72F1F63C9401DA1E38501F956C6AEFA355A4FE4C777BBB863CA5C23C521E947553E4414FE0253D291AF5656853830FB05B9D47D25F2E10C32FB91D6520DA2C35258BE84F327C78B201E0D03095DB771B36A4AEFDBD2B76C9226236A8C49A19FCAAF0FD761FC56EDCC9C64E865F56E63E4869D343ED8EB00A9E44AD8EE87993C09BF43C7C9DBCDEB4E7CD026FD6F3E68187FF1FDA748F2BABF01578C1BB1448CBDF4AC6640BD5A7C05C44472C5F04B791CBC6C8ACBB974FB47417C095A88292E228E4075EF4E7F5C25B32AA4D0E355E622315FA74C7EE17274BA66925CB7BDC30A41C1FE73EBB9A4C7EB5629CE3F04FEAE62F000000FFFF0300504B030414000600080000002100E5CAB34305010000AF01000014000000776F72642F77656253657474696E67732E786D6C8CD0514BC3301007F077C1EF50F2BEA6952152D60E4126BE0C61FA01D2F4DA06935CC8658BFBF6DE3615C497BDE5B8DC8FBBFF6AFDE96C718048067D2BEAB21205788D83F1532BDEDF368B075150527E50163DB4E20824D6DDEDCD2A3719FA1DA4C43FA960C553E3742BE694422325E9199CA21203786E8E189D4A5CC6493A153FF661A1D105954C6FAC4947795755F7E29B89D728388E46C313EABD039FCEF3328265113DCD26D08F96AFD132C62144D440C4F7387BF19C32FE97A997FF20677444C231957C8CBC6C244F148FD7D5F9E5AC289C6E5E268F51F59613CCF552741C9FB216F3EBF6599E8A01B79876EA008FB4E3052C6C8C05EEC83F31775F000000FFFF0300504B030414000600080000002100A46BFFF1B00700006B3D00001A000000776F72642F7374796C657357697468456666656374732E786D6CB49B6D53DB3810C7DFDFCC7D078FDF439E6868334D3B14DA2B336D8F3630F75AB115A2C1B67C9243E03EFDE9C1561C3B8E7763F715E058FBDFD5AE7E2B407AFFF1258EBC672A24E3C9DC1F9D0F7D8F26010F59F238F71FEEBF9CBDF53D99912424114FE8DC7FA5D2FFF8E1CF3FDE6F67327B8DA8F4948144CEB66930F7D75996CE060319AC694CE479CC02C1255F65E7018F077CB562011D6CB90807E3E16868BE4B050FA8944AED9A24CF44FAB9B998C3ACC524280C8F87C3B78398B0C4D9A87BC4539A287F575CC42493E75C3CAA11E269939E290F5392B1258B58F6AAFC1B4E9D99E7B9BF11C92C8FEACC45A5C7CC9403B3E7382A5E566E37BF6B676066BF1423442DD0034EDA21373CD8C434C98C7B034123E5304FE49AA5BB793BD59A9A8F75E1D2D1804BC16ED3D1454DCF4D0F24E937826C55EE0BE16D5A33776032423B288EEC3CE882DA9551D5E26808C88836E17C80B8B0AF5978522EBEED6953B3ABA46DAA16609705F597E09BD44595B26ED66E9327674B7300E1D9706A967A393489325063C5624D52EA7B7130BB7D4CB820CB4879A466DCD315E97F506C0A7970435764136552FF28EE44FE63FE93F9F2852799F4B6332203C6EE15B394959829835FAF12C97CF5092532BB928C943FFC9C3FD39FAFF58BE50FDDC8406625839F58C8FC811695FFA961CF249AFBE38BE2C9B57662EF594492C7E2194DCE1E166567E6BE7BB45476E73E11678B2B6D6C60222DBE96224E5DFCF6ADCAF4289028AC2C2CCFD5E4D1D5371E3CD17091A90FE6BEEA09E6E1C3ED9D605C2840CEFD77EFF2870B1AB3AF2C0CA96E1FC58BC99A85F49F354D1E240D77CF7F7E31E0CD2D067C93646A1E2EA72665910C3FBF0434D54C537A09D1E9F8A10728BAAA892BE91887366CE78D7D5051350FFF2D244776B60FAAAC29D10DCF33FE1F1532516F3A0B8D7544E5008C5D94AF93EE262EBA9B78D3DD846AB45DE7E2B2BB09B5CDE9EA85AD8D5255C2939AF1C0165FB92626EF8E94AC1E51ABA2D611B5A2691D51AB91D611B592681D51AB80D611B584B78EA8E5B775442D9D474704C480AB5A4513331BA0857DCFB24835B516D28D3AA22E6F0ADE1D11E4519074EDE92E5875FB182C179B650673D5E0F474582E32C1F5DEB06546C676199CCCE4CF71BA2692A92D749B50C7A9BFD7FB14EF2FC1D45EB345EA8D2DBE5A4C660B71B085DD4524A06B1E855478F7F4C5661431FE07F7162909CC667C1F841DB3F88D3DAE334FEDD874876D0D7CDA30C7CD815BFBDF9834211F6DDED38650DA8C8352366D28C366E3DF69C83671313580CDC7D4E21B91D58A8471F1F8145DE814D5D76C6B143A0190106C77C08760EC03FCB7BD046F5FE718E2BFED3C27DA07F86FFBD489F64D7D1CCF2F1A2C37EAEF231E68795DA2D7EE358FB8586DA2620DB4E2E112BD829D042C04F42276F64190B844AFE03D7C7A5741A07E5183D4293A173B8E2254D0E9B02A66B1C1634127A582BD11222274822A5A63845637D62284D0D0FD459F99FE8B30B619184ABBAD65EB729E34CC806A41A02DF3CF0DCFDAB7CCE306E641556E13F5D711493D98DAA461E541D5F27AB2FD0E91E36E8D0F21D4AD032284BAB5428450437D34EF795C4F848B746F8E082D34965D1733650726F3259ACC4E08D7027AEA9B80FD57C3EA6DAE857ADF04A8A01354EF9B001574762ABDCCF54D80566F7D13A0D5D0359A7354662A262874DF2C0BB99D0020A27EE00D10EA07DE00A17EE00D10EA0EEF7691FEE00DD042B3C131B50C6F80907905F3ABBE132AC31B20846683A55DFE37A3A2EF192BC77FB9ED01DE00157482EAF006A8A0B3D3046F809679055309152D873A80563FF00608F5036F80503FF00608F5036F80503FF00608758777BB487FF00668A1D9E0985A863740088D072754863740C8BC8261C341789B55FFDBE10D504127A80E6F800A3A3B15A0BA4D2A400B9DA08A96833740CBBC8229865CCB143726A87EE00D88A81F780384FA813740A81F780384BAC3BB5DA43F7803B4D06C704C2DC31B2084C683132AC31B208466C341789BC5F8DBE10D504127A80E6F800A3A3B15A03ACE01B4D009AA68397803B44CBD74863740C8BC72AA1026A27EE00D88A81F780384FA813740A83BBCDB45FA8337400BCD06C7D432BC0142683C38A132BC014268361C84B75923BF1DDE00157482EAF006A8A0B35301AA8337400B9DA08A96431D40AB1F7803844C6176863740C8BC72829059459834F5036F4044FDC01B20D41DDEED22FDC11BA0856683636A19DE0021341E9C5019DE0021341BF4B15A753C147C1A75D45004D07306C5A906B0E0B8214950C13CC05F744585BA6248DB4F8774142C22442836940734C44F9C3F79B073DC938602014BB165C4B839C1FD6A4EE994EE1D4C2E8F5C1CB8FFFBDAFB6AEFBBD4C69992DA3F79A3AE14956F07992B4CFA9E90F2337B4DD50D9DB43848AEADA99B43FACE557EE3C75C10BD55F77FF25B3C7AB0BED6A35E34B79DF2C7E6FFB6B9AAFA5E299A8175A960ADB4828C8A2352F9F9767706C99C6EAF0A371C82378EEC6E60146EE687E1777B28FBDEDE19CDA37E67FAE0F7119FCDC1F0A373E499576C56EB0EAABB58C6A5360F55CA96D19DD0B3A1BEB94D4215E136BF8C659319BE106B4A7D7E4DA3E83BB16FF3B4F9D588AE32FBE968683A60C5D49267198F9BC70B7340DC7872C8802A87B233F6471D44739D249B7849457EDCBCB12475E73017CFF64BD29E756D2805E84CEF7C2BBE931FFE070000FFFF0300504B030414000600080000002100C902872278010000ED02000011000801646F6350726F70732F636F72652E786D6C20A2040128A00001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008C52C16EC2300CBD4FDA3F54B997A445B0A96A8BB44D9C868404D3A6DDB2C440469B4449A0F4EF97B650A8B6C36EB1DFF3B3FD9C74762A8BE008C60A2533148D080A4032C585DC66E86D3D0F1F51601D959C164A42866AB06896DFDFA54C274C19581AA5C1380136F04AD2264C6768E79C4E30B66C0725B523CF901EDC285352E743B3C59AB23DDD028E0999E2121CE5D451DC0886BA57446749CE7A497D30452BC01986024A90CEE26814E12BD78129ED9F052D72C32C85ABB5DFE93CEEAD36671DD8B34F56F4C4AAAA46D5B81DC3CF1FE18FC5EBAA5D3514B2F18A01CA53CE12275C01798AAF4FFFB287AF6F60AE4BF781079801EA94C997859075B0F2FD776DE925DF38BE87BA52865B5F3D887C3907CB8CD0CEDFB1D31E243CBBA0D62DFC613702F8533D6CF31B6EBA19388AE65FE451DBAE0FFD6EAD95DDC8C0036F4ED2597941DEC7CF2FEB39CA63124D42F210C6D3754C92499410F2D96C35A86FCCEA12E579BEFF2BC643C58B4067D0F083E63F000000FFFF0300504B03041400060008000000210075A9F9D516070000093A00000F000000776F72642F7374796C65732E786D6CB49B51739B3810C7DF6FE6BE03C37BEAD84EE36BA64E274DDB6B66DA5E5A2773CF18645B53401C929BA49FFEA415280402EC1AF21403D2FEB5DAD56FB123BD7D779FC4DE2F964B2ED2A53F7D75EC7B2C0D45C4D3EDD2BFBDF974F497EF4915A451108B942DFD0726FD77E77FFEF1F6EE4CAA8798494F1B48E559122EFD9D52D9D96422C31D4B02F94A642CD50F37224F02A52FF3ED2409F29FFBEC2814491628BEE631570F93D9F1F1A95F98C93156C466C343F64184FB84A50AFA4F72166B8B22953B9EC9D2DA1DC6DA9DC8A32C172193523B9DC4D65E12F0D499999E340C253CCC85141BF54A3B33B1239A1853BAFBF4183E25B1EF25E1D9D5361579B08EF5E4DD4D4FFC733D7391083FB04DB08F953497F9755E5C1657F0E7934895F4EECE0219727EA3A7541B48B8B6F5F92295DCD74F5820D585E441F5E1C7E29E79BE330DAB0F5DCF50AA8AC1F73CE2FEC488CADFBADBAF205EFAB393F2CEA519C4937B71906ECB7B2C3DBA5D5507B3F4DDADB5B6BBF483FC6875618C4DC0D3F26FC5E3CCF96F5BD5A6470756877965B34D4F1EDB7C11E14F16AD947EB0F475C6C2CDDBABEB9C8B5C67D4D27FF3A6B8B96209FFCCA38899E42E1BA63B1EB17F772CBD952C7ABCFFFD13646A613114FB54E979589C42C862197DBC0F5966724CEBA58109C737D34147594F5C450706B4E78FA3B1376AAA70F3BF52726A67FB59951D0BCC72F460FC9D42E0F57EB0D0CC78547500EC92C63A1F6EE264B889D7C34D68320D9D8BC570131AC243476173A39295F8A02A11DAE4ABE6C4FC4D47CA9A1E8D2CEAEDD1489ADE1E8D1CE9EDD14889DE1E8D0CE8EDD108786F8F467C7B7B34C2D9D9230C005CF52C9AC36CA016F60D573133FD3B01341D88BAA22878D7411E6CF320DB79A60AD687DD05CBD57EAD7043059C1E0ECB95CA45BAED9D91995D060733F96392ED02C9F52B4DCFD4CF064EFD8D7945F1FECE79D42BF5DA265FC327788578B6845DC741C876228E58EEDDB07B1B5142FF6FC25B6541A8AB6033170C191BA6F44D545A7FE1DB9DF2563BA8B0BD8E9FB6CC71BBE3D6FE172EC1E5CEB573DA92907DC651213B6D49C376E35F59C4F749393588978F538BEF4628D01230C4EE293A81F0D3254C00302ED8EA70A07DC4F86D2DA1DB3731C68CDF569E03ED23C66FEBD481F6213FBAE34B06CB07FD85D2432DAF0579ED5E8A58E49B7D5CAE815E3C2CC82BD849E05C202F62671F05890579053FC1A7771186FA8B1A264FC9B178E42841851C0EAB028B0DEF0B392875B2123C2207A8A63523680D632D41880CDD1FEC1737BF57518B015401F76AD9BB9CE72D33807DB7F8BE17AAFF9579D6C23CACCA55AA7F1D91CCC3A9CD5B561E56ADC82798494A320D2B7C84641A56010942C34A2141A8253FDA5FAB5C4DC48B0C2F8E042D32965D1583B44393794126B313A2958091EA26E2FDAB65F5B6E742B36E2254C8016AD64D840A393AB55A362D530EA1355ADD4468B5548DF61855994A718A5C37AB420EDE088FC6813742681C782384C68137426838BCFB45C68337428BCC06C7D42ABC1142D0A4F9C34EFB32724255782384C86CB0B42B7E332A210456BABFDC8E006F840A39404D782354C8D1698337420B9A5032A1A6E55087D01A07DE08A171E08D101A07DE08A171E08D101A07DE08A1E1F0EE17190FDE082D321B1C53ABF0460891F1E084AAF0460841130A1B9E8537ACFA17873742851CA026BC112AE4E8D480EA5E52115AE400D5B41CBC115AD084920C85162437C5A971E08DF0681C782384C6813742681C78238486C3BB5F643C7823B4C86C704CADC21B2144C68313AAC21B214466C3B3F086C5F8E2F046A89003D4843742851C9D1A501DE7105AE400D5B41CBC115A902F83E18D108226870A513C1A07DE088FC6813742681C78238486C3BB5F643C7823B4C86C704CADC21B2144C68313AAC21B214466C3B3F08635F2E2F046A89003D4843742851C9D1A501DBC115AE400D5B41CEA105AE3C01B2104893918DE082168728010AC224A98C68137C2A371E08D101A0EEF7E91F1E08DD022B3C131B50A6F8410190F4EA80A6F8410990D665BADDE1E8ADE8D3A6D4902EC3E837257035A70D61224AC60E1E00FB661B93E00C5FA77870C142C3D2428B6A407D6C5F742FCF470FBB8E72D098296E2EB980BD8C1FD00BB742AE70EE68B8E830337FF5C7A9FED7997463F48A9A7BB7AF591A2EAE92038C264CE09E971AA874C9FD0C9CA8DE4C69A3E3964CE5C15277EE0F8DA953EFF539CE2319DCDB11EDD104E3B15B7E11F4E85AAFEAC15A163532ADC69AD50B1BC43AAD8DFEEF620C1EEF6BA70CB267818C8E3098C7298C566F8C77728DBEEC91ECDCE712BB3F1BB63CCB031BC738E3C6862A3DA1CA03E8B0543EA1BA10ED93ABECECD6CE80F5769A43DD407F8E0BF663698D17D604DE9E7972C8EBF06B6B5C8DA9BC66CA3ECD3E93154C09AA9B5504A24EDFD73D8200E2379CE804E87EA60ECA571A23D4FD27DB26679B195BD35254DE58083674F53D2EE756D4905EC4C3F8EADFC24CFFF070000FFFF0300504B0304140006000800000021006EE3125A16020000E707000012000000776F72642F666F6E745461626C652E786D6CDC54BB6EDB3014DD0BF41F04EEB12859490D2176D0A608D0A543E17E004D5116113E0492B2E2D5D93B77683FA1E8D0005DF23706B2E6177A255A86132B8033D612048AE7F21EDE7B70C8F38B1B29820533966B3546D100A38029AA33AEE663F4757A753242817544654468C5C668C92CBA98BC7D735EA7B956CE0690AF6C2AE91815CE9569185A5A3049EC40974C4130D746120753330F2531D7557942B52C89E3332EB85B8631C6676843630E61D179CE29FBA8692599726D7E68980046AD6CC14BDBB1D587B0D5DA64A5D194590B3D4BE1F924E16A4B13257B449253A3ADCEDD009A097D45614305E9116EFFA44081A4E9A7B9D286CC04685747099A6C840BEA541109E0259133C3491B2889D29645105B10314638C6093EC543F8127C0623CC51D830D08218CBDC7621F6704E2417CB0E2595D31E2FB9A345072F086C07F5F890E57308547686613FFF0C9147A22D02A668D7C47BC8F029427779A2260B905D1EA83EF4CED913E2F1FED7E3FD9FE0E1FBB7871F3F7BE5D8D4B73BF4CA31EA95C36849945FAFB49B9A8A4D97256BE57CA24FCE6F58F6A2386D532057D3D408BF6B6A792E4ED4212F89038EF759878B33E592D9E033AB832F6D1B8D7AFB6E895B97346E3905AF0C8FD92DEFC1C4A2D72531FE0032242040F71EFFA159AFEED6ABBFEBDBDBF5EA77AF288DE39E3DAF383A5267CCFCB767E792080E576CAF2E31BE6ACF4A6395E4E86ED8CD556B27FF000000FFFF0300504B03041400060008000000210037CBA63881010000DB02000010000801646F6350726F70732F6170702E786D6C20A2040128A00001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000009C52C14EDC3010BD57EA3F44B9B3CE5655D5A259A36A11EA012AA40D701ED993C4C2F158B641ECDF7742D810C4AD3ECD7B337A7EF36CB878197DF54C293B0EBB7ABB69EA8A8261EB42BFABEFDAABB39F75950B068B9E03EDEA23E5FA427FFD02B78923A5E228572211F2AE1E4A89E74A6533D0887923ED209D8ED3884560EA15779D3374C9E669A450D4B7A6F9A1E8A550B064CFE22258CF8AE7CFE57F452D9BC95FBE6F8F510C6B68698C1E0BE9BF931DBFB15C46500B0B2D17F4AD1B496F855E00DC624F79E2E6021E38D9573C17B01F30A129929FFE056A85E0778CDE192C92ABBE712671E6AE5437685C289C876A1200B59E0209E640E629B972D40DA835846B1766237321C612F609E3F0E66E417030E8692FDBEB0E7D2650EF04EC798C188EFA1A1FA9BAE244B9547BF69E7A993B35A7BB1EF35D6CF9724AEC4DE523B95AFCC195E110D188BD0F11AC7838484C6465A193DA3B017FE489929FAE94F8424FF634F3B931857A3FFF55BDFDBE69E4BC4678E2E499964FA4FF010000FFFF0300504B01022D0014000600080000002100621D98467A0100008E0500001300000000000000000000000000000000005B436F6E74656E745F54797065735D2E786D6C504B01022D0014000600080000002100C2609AF3F40000004E0200000B00000000000000000000000000B30300005F72656C732F2E72656C73504B01022D0014000600080000002100006875E120010000B90300001C00000000000000000000000000D8060000776F72642F5F72656C732F646F63756D656E742E786D6C2E72656C73504B01022D00140006000800000021007A2B808D4B0200007606000011000000000000000000000000003A090000776F72642F646F63756D656E742E786D6C504B01022D00140006000800000021009D5C8BBE10070000871D00001500000000000000000000000000B40B0000776F72642F7468656D652F7468656D65312E786D6C504B01022D00140006000800000021008F705570C50300008F0900001100000000000000000000000000F7120000776F72642F73657474696E67732E786D6C504B01022D0014000600080000002100E5CAB34305010000AF0100001400000000000000000000000000EB160000776F72642F77656253657474696E67732E786D6C504B01022D0014000600080000002100A46BFFF1B00700006B3D00001A0000000000000000000000000022180000776F72642F7374796C657357697468456666656374732E786D6C504B01022D0014000600080000002100C902872278010000ED02000011000000000000000000000000000A200000646F6350726F70732F636F72652E786D6C504B01022D001400060008000000210075A9F9D516070000093A00000F00000000000000000000000000B9220000776F72642F7374796C65732E786D6C504B01022D00140006000800000021006EE3125A16020000E70700001200000000000000000000000000FC290000776F72642F666F6E745461626C652E786D6C504B01022D001400060008000000210037CBA63881010000DB0200001000000000000000000000000000422C0000646F6350726F70732F6170702E786D6C504B0506000000000C000C0009030000F92E00000000';
    public static String bigZip = '504B030414000808080002266D4700000000000000000000000032000000756E7061636B616765642F74726967676572732F4D65726368616E7441646472657373547269676765722E74726967676572E5545D4BC330147DDFAFC8630BA57F407CE836101FA6D22A822F254B6EEB65310949BA29B2FF6EDAA5C5C21EEC6053304FBD5FE7F4DC1CE20CD63518B202C35EA97419E706AC7D0C6925874A194A60CB9291680D953240505A302E21216C34A70E12422BE7A7FBE2211AD73808701093CF19F1E7A627644A3A7877E49A48D80DE928BE9A757D589128B4A468E71DE96DC7D223B5274C1560B6C8C0A6A69121F5ACCCA6126A17B5E80B2A29472A5F502F140F3885A60C86B63096FAF6A4874D95E0B1FFA1896C9E2593BC68D64BDCA245251F946E0475FE6BE80BD27AF4FD31D159BBBED3351BE0E872B49B82F9DDE54A88461F93BBA27AA4D8C797113D017DE5ED486B983776D2060FB679EAEC785EDBDC7DB7CDFDEFDBE674CD97B54DF121590E1CDE74AB737878FE994FBB2B5B8EDEC9BF7B653FD1B8FF02504B070882804235390100006E060000504B030414000808080002266D470000000000000000000000003B000000756E7061636B616765642F74726967676572732F4D65726368616E7441646472657373547269676765722E747269676765722D6D6574612E786D6C4D8DCB0AC2301444F7F98A90BDB9B148114953BAF10BAAFB905E6BC03C48AEA59F6FA12E3ABB19CE7074BF860F5FB0549F6227CE52098ED1A5C9C7B9138FF17EBA8ADE303D645CC7E2E7190BDF1EB176E24D946F0035D92CEB2B1587D2A5008D522DA80B04243B59B2C230BE45DBEC9FBBC634AD541A0EC34E54B2F4AD6670E417D4F0AF4CC3416ED80F504B070812A482A28A000000B2000000504B030414000808080002266D4700000000000000000000000016000000756E7061636B616765642F7061636B6167652E786D6C4D4FCB0E823010BCF3154DEF76AB12634C29E1E2CDC4037E402D2B10ED236D63F0EF25808F3DCDECCECE6444399807796288BDB3055D334E095AED9ADEB605BDD4C7D59E96321367A5EFAA4532AA6D2C6897923F0044A73C8B37173432ED0C6C38DF01CFC160528D4A8ACA8C8C23D2CB639CF1C40D9AEB18294F1874A76CAA9A26608C75E8DB168380CFFDF761954159791CBE9A6933DBC39FBF58BAC86DCEB8800FCB042C1564F606504B07084E999336A9000000F4000000504B0102140014000808080002266D4782804235390100006E060000320000000000000000000000000000000000756E7061636B616765642F74726967676572732F4D65726368616E7441646472657373547269676765722E74726967676572504B0102140014000808080002266D4712A482A28A000000B20000003B0000000000000000000000000099010000756E7061636B616765642F74726967676572732F4D65726368616E7441646472657373547269676765722E747269676765722D6D6574612E786D6C504B0102140014000808080002266D474E999336A9000000F400000016000000000000000000000000008C020000756E7061636B616765642F7061636B6167652E786D6C504B050600000000030003000D010000790300000000'; 
    
    private Map<String,fileObject> zipFileMap = new Map<String, fileObject>{};
    private Boolean unZipping = false;  //if zipping a file, false.  If UnZipping a file, true
    protected String zipFileString;  // stores the Hex version of the file blob
    
    // Zipper Zip  Contructor
    public Zipper(){}
   
    //  Zipper UnZipping Constructor
    public Zipper(Blob fileData)
    {   
        unZipping = true;
        zipFileString = EncodingUtil.convertToHex(fileData);
        Integer offsetOfEndCentralDirSignature = zipFileString.lastIndexOf(endCentralDirSignature);
        Long numberOfFiles = HexUtil.hexToIntLittleEndian(zipFileString.substring(offsetOfEndCentralDirSignature+10*2,offsetOfEndCentralDirSignature+10*2+2*2));    //offset 10, 2 bytes
        Long startOfCentralDir = HexUtil.hexToIntLittleEndian(zipFileString.substring(offsetOfEndCentralDirSignature+16*2,offsetOfEndCentralDirSignature+16*2+4*2));  //offset 16, 4 bytes
    
        //System.debug (numberOfFiles + ',  ' + startOfCentralDir);
        Integer offset = (Integer)startOfCentralDir;
        
        for (Integer fileLoop = 0; fileLoop < numberOfFiles; fileLoop++)
        {
            fileObject tempFile = new fileObject(zipfileString, offset);
            zipFileMap.put(EncodingUtil.convertFromHex(tempFile.fileName).toString(), tempFile);
            offset = tempFile.offsetToNextRecord;
    
        }
        //System.debug(zipFileMap.keySet());
    }
    
    
    // returns the list of file names generated by Zipper class
    public Set<String> getFileNames()
    {
        return zipFileMap.keySet();
    }
    
    public Blob getFile(String fileName)
    {
        fileObject tempFileObject =  zipFileMap.get(fileName);
        tempFileObject.readLocalFileHeader(zipFileString, (Integer)HexUtil.hexToIntLittleEndian( tempFileObject.offsetOfLH));
        if (tempFileObject.compressionMethod == '0000')
        {
            return EncodingUtil.convertFromHex(tempFileObject.compressedFileData);
        }
        else {
            System.assert(false,'Unsupported compression method: ' + tempFileObject.compressionMethod);
            return null;
        }
    }
    
    
    // Local File Header
    final static String LFHSignature = '504b0304';      
    
    
    // Central Directory 
    final static String CFHSignature = '504b0102';  // little Endian Central file header signature
    
    
    // End of Central Directory records
    final String endCentralDirSignature ='504b0506'; //Little Endian formatted signature (4 bytes)
    final String numberOfThisDisk = '0000'; // (2 bytes)
    final String numberOfTheDiskWithStartCentralDir = '0000'; //(2 bytes)
    private String totalNumberOfEntriesInTheCentralDirOnThisDisk =  '0000' ;//(2 bytes)
    private String totalNumberOfEntriesCentralDir  = '0000'; //(2 bytes)
    private String sizeOfCentralDir  = '00000000'; //(4 bytes)
    private String offsetOfStartOfCentralDir = '00000000'; //(4 bytes)
    final String zipfileCommentLength = '0000';  //(this is c), (2 bytes)
    final String zipfileComment = '00'; // (c bytes)
    
    
    private String assembleEndOfCentralDir ()
    {
        return endCentralDirSignature + numberOfThisDisk + numberOfTheDiskWithStartCentralDir + totalNumberOfEntriesInTheCentralDirOnThisDisk +
            totalNumberOfEntriesCentralDir  + sizeOfCentralDir + offsetOfStartOfCentralDir +
            zipfileCommentLength + zipfileComment;
    }
    
    
    public Blob getZipFile ()
    {
        if (unZipping)
        {
            return EncodingUtil.convertFromHex(zipFileString);
        }
        String zipFileBuffer ='';
        Integer zipFileSize = 0;
        for (fileObject tempFileObject : zipFileMap.values())
        {
            tempFileObject.OffsetOfLH = returnLEHexStringOfDecimal(zipfileSize, 4);
            zipFileBuffer += tempFileObject.assembleLocalFileHeader();
            zipfileSize = zipFileBuffer.length()/2;
            tempFileObject.compressedFileData = null;
        }
        offsetOfStartOfCentralDir = returnLEHexStringOfDecimal(zipfileSize,4);
        for (fileObject tempFileObject : zipFileMap.values())
        {
            zipFileBuffer += tempFileObject.assembleCentralFileHeader();
        }
        sizeOfCentralDir = returnLEHexStringOfDecimal(zipFileBuffer.length()/2 - zipfileSize,4);
        totalNumberOfEntriesInTheCentralDirOnThisDisk = returnLEHexStringOfDecimal(zipFileMap.size(),2);
        totalNumberOfEntriesCentralDir = returnLEHexStringOfDecimal(zipFileMap.size(),2);
        
        zipFileBuffer += assembleEndOfCentralDir();
        
        zipFileMap.clear();

        //System.debug(zipFileBuffer);
        return EncodingUtil.convertFromHex(zipFileBuffer);
    }
    
	public void addFileToZip (String fileName, Blob fileData, String crc32)
    {
        fileObject tempFileObject = new fileObject();
        
        tempFileObject.lastModTime = HexUtil.intToHex(getCurrentTime(),2); // (2 bytes) 
        tempFileObject.lastModDate = HexUtil.intToHex(getCurrentDate(),2); // (2 bytes)
        
        //tempFileObject.CRC32 = HexUtil.intToHex(HexUtil.CRC32Table(fileData),4);// (4 bytes) 
        tempFileObject.crc32 = crc32;


        tempFileObject.uncompressedSize = returnLEHexStringOfDecimal(fileData.size(), 4);// (4 bytes) 
        tempFileObject.compressedSize = tempFileObject.uncompressedSize;// (4 bytes), creates (n)
    
        tempFileObject.fileNameLength = returnLEHexStringOfDecimal(fileName.length(), 2);// (2 bytes), creates (f)
    
        //tempFileObject.extraFieldLength = '1C00';// (2 bytes) , creates (e)
        tempFileObject.extraFieldLength = '0000';// (2 bytes) , creates (e)
        tempFileObject.fileCommentLength = '0000';// (2 bytes), creates (c)
        tempFileObject.diskNumStart = '0000';// (2 bytes) 
        tempFileObject.internalFileAtt = '0000';// (2 bytes) //Internal file attributes
        tempFileObject.externalFileAtt = '0000A481';// (4 bytes) //External file attributes
    
        tempFileObject.fileName = EncodingUtil.convertToHex(Blob.valueOf(fileName));// (f bytes) // from the parameters passed
    
    
        // tempFileObject.extraField = '5554090003CD16C3544017C35475780B000104F60100000414000000';// (e bytes) 
        tempFileObject.extraField = '';
        // tempFileObject.fileComment = '00';// (c bytes) 
        tempFileObject.fileComment = '';// (c bytes) 
    
        tempFileObject.compressedFileData = EncodingUtil.convertToHex(fileData); // (n bytes) // from the parameters passed
        
        zipFileMap.put(fileName, tempFileObject);  //add the new subFile to the Zip List
    }
    
    public String returnLEHexStringOfDecimal (Integer decimalNumber, Integer sizeInBytes)
    {
        String LEHexStringOfDecimal = '';
        Integer remainder = 0;
        Integer byteLocation = 0;
        String tempRightDigit ='0';
        String tempLeftDigit ='0';
        while (decimalnumber > 0)
        {
            remainder = math.mod(decimalnumber, 16);
            decimalnumber = decimalnumber / 16;
            if (remainder == 1) tempRightDigit = '1';
            if (remainder == 2) tempRightDigit = '2';
            if (remainder == 3) tempRightDigit = '3';
            if (remainder == 4) tempRightDigit = '4';
            if (remainder == 5) tempRightDigit = '5';
            if (remainder == 6) tempRightDigit = '6';
            if (remainder == 7) tempRightDigit = '7';
            if (remainder == 8) tempRightDigit = '8';
            if (remainder == 9) tempRightDigit = '9';
            if (remainder == 10) tempRightDigit = 'A';
            if (remainder == 11) tempRightDigit = 'B';
            if (remainder == 12) tempRightDigit = 'C';
            if (remainder == 13) tempRightDigit = 'D';
            if (remainder == 14) tempRightDigit = 'E';
            if (remainder == 15) tempRightDigit = 'F';
            
            if (remainder == 0)  tempRightDigit = '0';
                    remainder = math.mod(decimalnumber, 16);
                    decimalnumber = decimalnumber / 16;
                        if (remainder == 0) tempLeftDigit = '0';
                        if (remainder == 1) tempLeftDigit = '1';
                        if (remainder == 2) tempLeftDigit = '2';
                        if (remainder == 3) tempLeftDigit = '3';
                        if (remainder == 4) tempLeftDigit = '4';
                        if (remainder == 5) tempLeftDigit = '5';
                        if (remainder == 6) tempLeftDigit = '6';
                        if (remainder == 7) tempLeftDigit = '7';
                        if (remainder == 8) tempLeftDigit = '8';
                        if (remainder == 9) tempLeftDigit = '9';
                        if (remainder == 10) tempLeftDigit = 'A';
                        if (remainder == 11) tempLeftDigit = 'B';
                        if (remainder == 12) tempLeftDigit = 'C';
                        if (remainder == 13) tempLeftDigit = 'D';
                        if (remainder == 14) tempLeftDigit = 'E';
                        if (remainder == 15) tempLeftDigit = 'F';
             
             LEHexStringOfDecimal = LEHEXStringOfDecimal + tempLeftDigit + tempRightDigit;
             byteLocation++;
        }
        for (Integer x = byteLocation; x < sizeInBytes; x++)
            LEHexStringOfDecimal = LEHexStringOfDecimal + '00';
        
        return LEHexStringOfDecimal;
    }
    

    public void removePrefix(String prefix)
    {
        String newDataStr, oldDataStr, fileName, extraField, oldCentralDirStr, newCentralDirStr;
        Integer fileNameLength, extraFieldLength;
        prefix = EncodingUtil.convertToHex(Blob.valueOf(prefix));
        for (fileObject tempFO : zipFileMap.values())
        {
            fileName = tempFO.fileName;
            extraField = tempFO.extraField;
            oldDataStr = tempFO.fileNameLength + tempFO.extraFieldLength + fileName + extraField;
 
            fileNameLength = (Integer)HexUtil.hexToIntLittleEndian(tempFO.fileNameLength) - prefix.length()/2;
            extraFieldLength = (Integer)HexUtil.hexToIntLittleEndian(tempFO.extraFieldLength) + prefix.length()/2;
            newDataStr = hexUtil.intToHex(fileNameLength,2) + hexUtil.intToHex(extraFieldLength,2);
            newDataStr += fileName.removeStart(prefix) + extraField + hexUtil.intToHex(0,prefix.length()/2);

            oldCentralDirStr = tempFO.fileNameLength + tempFO.extraFieldLength + tempFO.fileCommentLength + 
                tempFO.diskNumStart + tempFO.internalFileAtt + tempFO.externalFileAtt + tempFO.offsetOfLH + 
                tempFO.fileName + tempFO.extraField;

            newCentralDirStr = hexUtil.intToHex(fileNameLength,2) + hexUtil.intToHex(extraFieldLength,2) + 
                tempFO.fileCommentLength +    tempFo.diskNumStart + tempFO.internalFileAtt + 
                tempFO.externalFileAtt + tempFO.offsetOfLH + 
                fileName.removeStart(prefix) + extraField + hexUtil.intToHex(0,prefix.length()/2);

            if(fileName.startsWith(prefix))
            {
                zipFileString = zipFileString.replace(oldDataStr,newDataStr);
                zipFileString = zipFileString.replace(oldCentralDirStr, newCentralDirStr);
                //System.debug(oldDataStr);
                //System.debug(newDataStr);

            }
        }

    }


    public static Integer getCurrentTime()
    {
        Datetime d = Datetime.now();
        Integer zipTimeStamp = d.hour();
        zipTimeStamp <<= 6;
        zipTimeStamp |= d.minute();
        zipTimeStamp <<= 5;
        zipTimeStamp |= d.second() / 2;
        
        return zipTimeStamp;
    }
    
    
    
    public static Integer getCurrentDate()
    {
        Datetime d = Datetime.now();
        Integer zipDateStamp = d.year() - 1980;
        zipDateStamp <<= 4;
        zipDateStamp |= d.month();
        zipDateStamp <<= 5;
        zipDateStamp |= d.day();
    
        return zipDateStamp;
    }

    public class fileObject
    {
    // note all strings are hex representations in little endian format
        
        public String creatorVersion = '0A00'; // (2 bytes) likely Windows NT
        public String minExtractorVersion = '0A00'; // (2 bytes) likely Windows NT
        public String gPFlagBit = '0000';  // (2 bytes) general purpose flag bit
        public String compressionMethod = '0000'; // (2 bytes) no compression
        public String lastModTime = '0000';// (2 bytes) 
        public String lastModDate = '0000';// (2 bytes) 
        public String crc32 = null;// (4 bytes) 
        public String compressedSize = '01000000';// (4 bytes), creates (n)
        public String uncompressedSize = '00000000';// (4 bytes) 
        public String fileNameLength = '01000000';// (2 bytes), creates (f)
        public String extraFieldLength = '0000';// (2 bytes) , creates (e)
        public String fileCommentLength = '0000';// (2 bytes), creates (c)
        public String diskNumStart = '0000';// (2 bytes) 
        public String internalFileAtt = '0000';// (2 bytes) 
        public String externalFileAtt = '00000000';// (4 bytes) 
        public String offsetOfLH = '00000000';// (4 bytes) 
        public String fileName = '00';// (f bytes) 
        public String extraField = '00';// (e bytes) 
        public String fileComment = '00';// (c bytes) 
        public String compressedFileData = '00';// (n bytes)
        public Integer offsetToNextRecord = 0;  //offsetToNext Record
    
    
        // Constructor
        public fileObject(){}

        public fileObject (String zipFileString, Integer offset)
        {
        offset *=2;
        creatorVersion = zipFileString.substring(offset+4*2, offset+4*2 + 2*2); // (2 bytes) likely Windows NT  Offset 4
        minExtractorVersion = zipFileString.substring(offset+6*2, offset+6*2 + 2*2); // (2 bytes) likely Windows NT  Offset 6
        GPFlagBit = zipFileString.substring(offset+8*2, offset+8*2 + 2*2);  // (2 bytes) general purpose flag bit  Offset 8
        compressionMethod = zipFileString.substring(offset+10*2, offset+10*2 + 2*2); // (2 bytes) no compression  Offset 10
        lastModTime = zipFileString.substring(offset+12*2, offset+12*2 + 2*2);// (2 bytes)   Offset 12
        lastModDate = zipFileString.substring(offset+14*2, offset+14*2 + 2*2);// (2 bytes)    Offset 14
        CRC32 = zipFileString.substring(offset+16*2, offset+16*2 + 4*2);// (4 bytes)      Offset 16
        compressedSize = zipFileString.substring(offset+20*2, offset+20*2 + 4*2);// (4 bytes), creates (n)     Offset 20
        uncompressedSize = zipFileString.substring(offset+24*2, offset+24*2 + 4*2);// (4 bytes)      Offset 24
        fileNameLength = zipFileString.substring(offset+28*2, offset+28*2 + 2*2);// (2 bytes), creates (f)     Offset 28
        extraFieldLength = zipFileString.substring(offset+30*2, offset+30*2 + 2*2);// (2 bytes) , creates (e)     Offset 30
        fileCommentLength = zipFileString.substring(offset+32*2, offset+32*2 + 2*2);// (2 bytes), creates (c)     Offset 32
        diskNumStart = zipFileString.substring(offset+34*2, offset+34*2 + 2*2);// (2 bytes)     Offset 34
        internalFileAtt = zipFileString.substring(offset+36*2, offset+36*2 + 2*2);// (2 bytes)      Offset 36
        externalFileAtt = zipFileString.substring(offset+38*2, offset+38*2 + 4*2);// (4 bytes)     Offset 38
        OffsetOfLH = zipFileString.substring(offset+42*2, offset+42*2 + 4*2);// (4 bytes)     Offset 42
        offset = offset /2;
        Integer theStart = offset+46;
        Integer theEnd = theStart + (Integer)HexUtil.hexToIntLittleEndian(fileNameLength);
        fileName = zipFileString.substring(theStart*2, theEnd*2);// (f bytes)       Offset 46
        theStart = theEnd;
        theEnd = theStart + (Integer)HexUtil.hexToIntLittleEndian(extraFieldLength);
        extraField = zipFileString.substring(theStart*2, theEnd * 2);// (e bytes)        Offset 46 + fileNameLength
        theStart = theEnd;
        theEnd = theStart + (Integer)HexUtil.hexToIntLittleEndian(fileCommentLength);
        fileComment = zipFileString.substring(theStart*2, theEnd*2);// (c bytes)        Offset 46 + fileNameLength + extraFieldLength
        offsetToNextRecord = theEnd;
        //System.debug(this);
        }
        
        
        public void readLocalFileHeader (String zipFileString, Integer offset)
        {
            offset *=2;
            minExtractorVersion = zipFileString.substring(offset+4*2, offset+4*2 + 2*2); // (2 bytes) likely Windows NT  Offset 4
            GPFlagBit = zipFileString.substring(offset+8*2, offset+6*2 + 2*2);  // (2 bytes) general purpose flag bit  Offset 6
            compressionMethod = zipFileString.substring(offset+8*2, offset+8*2 + 2*2); // (2 bytes) no compression  Offset 8
            lastModTime = zipFileString.substring(offset+10*2, offset+10*2 + 2*2);// (2 bytes)   Offset 10
            lastModDate = zipFileString.substring(offset+12*2, offset+12*2 + 2*2);// (2 bytes)    Offset 12
            CRC32 = zipFileString.substring(offset+14*2, offset+14*2 + 4*2);// (4 bytes)      Offset 14
            compressedSize = zipFileString.substring(offset+18*2, offset+18*2 + 4*2);// (4 bytes), creates (n)     Offset 18
            uncompressedSize = zipFileString.substring(offset+22*2, offset+22*2 + 4*2);// (4 bytes)      Offset 22
            fileNameLength = zipFileString.substring(offset+26*2, offset+26*2 + 2*2);// (2 bytes), creates (f)     Offset 26
            extraFieldLength = zipFileString.substring(offset+28*2, offset+28*2 + 2*2);// (2 bytes) , creates (e)     Offset 28
       
       
            offset = offset /2;
            Integer theStart = offset+30;
            Integer theEnd = theStart + (Integer)HexUtil.hexToIntLittleEndian(fileNameLength);
            fileName = zipFileString.substring(theStart*2, theEnd*2);// (f bytes)       Offset 30
            theStart = theEnd;
            theEnd = theStart + (Integer)HexUtil.hexToIntLittleEndian(extraFieldLength);
            extraField = zipFileString.substring(theStart*2, theEnd * 2);// (e bytes)        Offset 30 + fileNameLength
            theStart = theEnd;
            theEnd = theStart + (Integer)HexUtil.hexToIntLittleEndian(compressedSize);
            compressedFileData = zipFileString.substring(theStart*2, theEnd*2);// (c bytes)        Offset 30 + fileNameLength + extraFieldLength
            offsetToNextRecord = theEnd;
            
            System.debug('local file header ' + this);
        
        }

        public String assembleLocalFileHeader()
        {
		    if (String.isBlank(crc32)) {  
		        crc32 = HexUtil.intToHex(HexUtil.CRC32Table(compressedFileData), 4);// (4 bytes) 
		    }
            return Zipper.LFHSignature + minExtractorVersion + GPFlagBit + compressionMethod +lastModTime + lastModDate + 
                    crc32 + compressedSize + uncompressedSize + fileNameLength + extraFieldLength + fileName + extraField +
                    compressedFileData;
        }

        public String assembleCentralFileHeader()
        {
		    if (String.isBlank(crc32)) {  
		        crc32 = HexUtil.intToHex(HexUtil.CRC32Table(compressedFileData), 4);// (4 bytes) 
		    }
            return Zipper.CFHSignature + creatorVersion + minExtractorVersion + GPFlagBit + compressionMethod +lastModTime + lastModDate
                    + crc32 + compressedSize + uncompressedSize + fileNameLength + extraFieldLength
                    + fileCommentLength + diskNumStart + internalFileAtt + externalFileAtt + offsetOfLH + fileName 
                    + extraField + fileComment;
        }
    }// end of fileObject class
}